__freebayes__output = cfg.PROJECT + "/freebayes/%s.vcf" % cfg.PROJECT

rule freebayes:
    input:
        bam = __freebayes__input,
        ref = __bwa_mem_ref__reference
    output:
        vcf = __freebayes__output
    log:
        out = cfg.PROJECT + "/logs/freebayes/stdout.logs",
        err = cfg.PROJECT + "/logs/freebayes/stderr.logs"
    params:
        freebayes = config["freebayes"]["options"]
    shell:
        """
        samtools index {input.bam}
        freebayes {params.freebayes} -f {input.ref} \
        -b {input.bam} -v {output.vcf} > {log.out} 2> {log.err}
        """
